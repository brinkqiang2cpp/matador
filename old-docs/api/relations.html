<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"> 
<html lang="de"> 
  <head> 
    <meta http-equiv="content-type" content="text/html; charset=utf-8"/> 
    <title>Open Object Store</title> 
  	<link rel="stylesheet" type="text/css" href="style.css" />
  </head> 
  <body>
    <div id="header">
      <a href="https://github.com/zussel/oos"><img style="z-order: 10000; float: left; top: 0; left: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_left_green_007200.png" alt="Fork me on GitHub"></a>
      <div id="navigation">
        <h1>OOS</h1>
        <p>Store all your objects in one container</p>
        <ul>
          <li><a href="../index.html">Home</a></li>
          <li class="selected">Documention</li>
          <li><a href="../download.html">Download</a></li>
          <!--li><a href="../contact.html">Contact</a></li-->
          <li><a href="../about.html">About</a></li>
        </ul>
      </div>
    </div>
    <div id="wrapper">
      <div id="content">
        <div>
<!-- Generated by Doxygen 1.8.6 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Overview</span></a></li>
      <li><a href="annotated.html"><span>Documentation</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Object Relations </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"> 
<div class="width75 float_left">
 
<table id="doc_nav"><tbody><tr>
  <td><div class="left-arrow-top"></td>
  <td align="left" width="40%">Prev</td>
  <td align="center" width="20%"></td>
  <td align="right" width="40%">Next</td>
  <td><div class="right-arrow-top"></td></tr><tr>
  <td><div class="left-arrow-bottom"></td>
  <td align="left" width="40%">
 <a class="el" href="store.html">Object Store</a>  
  </td>
  <td width="20%"></td>
  <td align="right" width="40%">
 <a class="el" href="view.html">Object Views</a>  
  </td><td><div class="right-arrow-bottom"></td>
</tr></tbody></table>
<h1><a class="anchor" id="object_relations_sec"></a>
Object relations</h1>
<p>When it comes to object relations you can use one to one and one to many relations in a straight forward way.</p>
<h2><a class="anchor" id="one_to_one"></a>
OneToOne relations</h2>
<p>In this example we have two object types an address class and a person class.</p>
<div class="fragment"><div class="line"><span class="keyword">class </span>address : <span class="keyword">public</span> <a class="code" href="classoos_1_1object.html">oos::object</a></div>
<div class="line">{</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">  <span class="comment">//...</span></div>
<div class="line"></div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">  std::string street_;</div>
<div class="line">  std::string city_;</div>
<div class="line">};</div>
</div><!-- fragment --><p>Each person class should have an address, so we add an <a class="el" href="classoos_1_1object__ptr.html" title="The object_ptr holds a pointer to an object. ">oos::object_ptr</a> of type address to the members. That's it. Now we have a one to one relationship beetween two classes.</p>
<div class="fragment"><div class="line"><span class="keyword">class </span>person : <span class="keyword">public</span> <a class="code" href="classoos_1_1object.html">oos::object</a></div>
<div class="line">{</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">  <span class="comment">//...</span></div>
<div class="line"></div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">  <a class="code" href="classoos_1_1object__ptr.html">oos::object_ptr&lt;address&gt;</a> address_;</div>
<div class="line">};</div>
</div><!-- fragment --><p>With this kind of relationship we have a hard linked relationship. Which means if we remove the person from our store the address object is removed as well.</p>
<p>In case we want to keep the address object we can use a <a class="el" href="classoos_1_1object__ref.html" title="The object_ref holds a pointer to an object. ">oos::object_ref</a> of type adress instead of object_ptr.</p>
<div class="fragment"><div class="line"><span class="keyword">class </span>person : <span class="keyword">public</span> <a class="code" href="classoos_1_1object.html">oos::object</a></div>
<div class="line">{</div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">  <a class="code" href="classoos_1_1object__ref.html">oos::object_ref&lt;address&gt;</a> address_;</div>
<div class="line">};</div>
</div><!-- fragment --><p>With object_ref we have a soft link to the address inside our person class and it won't be removed on a person removal. We must explicitly remove the address.</p>
<h2><a class="anchor" id="one_to_many"></a>
OneToMany relations</h2>
<p>When it comes to one to many releationships it is also quiet easy. OOS comes with three types of container classes which can be used to setup one to many relationships.</p>
<ul>
<li><a class="el" href="classoos_1_1object__vector.html" title="Object vector class without relation table. ">oos::object_vector</a></li>
<li><a class="el" href="classoos_1_1object__list.html" title="List class mapping items via relation table. ">oos::object_list</a></li>
<li><a class="el" href="classoos_1_1linked__object__list.html" title="An linked object list class. ">oos::linked_object_list</a></li>
</ul>
<p>Because these classes are designed in the same way as the STL classes we can use them in the same way plus the benefit of the relationship.</p>
<p>Our handy person class needs a list of friends which are also of type person. And because we want this list with soft linked person we use <a class="el" href="classoos_1_1object__ref.html" title="The object_ref holds a pointer to an object. ">oos::object_ref</a> as the type of the list.</p>
<div class="fragment"><div class="line"><span class="keyword">class </span>person : <span class="keyword">public</span> <a class="code" href="classoos_1_1object.html">oos::object</a></div>
<div class="line">{</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">  <span class="comment">// the value type of the list</span></div>
<div class="line">  <span class="keyword">typedef</span> <a class="code" href="classoos_1_1object__ref.html">oos::object_ref&lt;person&gt;</a> person_ref;</div>
<div class="line">  <span class="comment">// the list definition</span></div>
<div class="line">  <span class="keyword">typedef</span> <a class="code" href="classoos_1_1object__list.html">oos::object_list&lt;person_ref&gt;</a> person_list_t;</div>
<div class="line">  <span class="comment">// shortcuts to the iterators</span></div>
<div class="line">  <span class="keyword">typedef</span> person_list_t::iterator iterator;</div>
<div class="line">  <span class="keyword">typedef</span> person_list_t::const_iterator const_iterator;</div>
<div class="line"></div>
<div class="line">  <span class="comment">// c&#39;tor for person</span></div>
<div class="line">  person(<span class="keyword">const</span> std::string &amp;name)</div>
<div class="line">    : name_(name)</div>
<div class="line">    <span class="comment">// the list need the person to handle the relationship</span></div>
<div class="line">    , friends_(this) </div>
<div class="line">  {}</div>
<div class="line"></div>
<div class="line">  std::string name()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> name_; }</div>
<div class="line"></div>
<div class="line">  <span class="comment">// add a friend to persons friend list</span></div>
<div class="line">  <span class="keywordtype">void</span> add_friend(<span class="keyword">const</span> person_ref &amp;p)</div>
<div class="line">  {</div>
<div class="line">    friends_.push_back(p);</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  <span class="comment">// STL like iterators</span></div>
<div class="line">  iterator begin() { <span class="keywordflow">return</span> friends_.begin(); }</div>
<div class="line">  iterator end() { <span class="keywordflow">return</span> friends_.end(); }</div>
<div class="line"></div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">  std::string name_;</div>
<div class="line">  person_list_t friends_;</div>
<div class="line">};</div>
</div><!-- fragment --><p>Why declare a list if we don't use it? Next is an example howto to use our persons friend list.</p>
<p>We insert a new person into the object_store. Than we insert and immediatily add some persons as friends to our first person.</p>
<div class="fragment"><div class="line"><span class="keyword">typedef</span> <a class="code" href="classoos_1_1object__ptr.html">oos::object_ptr&lt;person&gt;</a> person_ptr;</div>
<div class="line"></div>
<div class="line"><span class="comment">// create a new person</span></div>
<div class="line">person_ptr p = ostore.<a class="code" href="classoos_1_1object__store.html#a77514ee78979a91d2745f01184371e11">insert</a>(<span class="keyword">new</span> person(<span class="stringliteral">&quot;joe&quot;</span>));</div>
<div class="line"></div>
<div class="line"><span class="comment">// add some friends</span></div>
<div class="line">p-&gt;add_friend(ostore.<a class="code" href="classoos_1_1object__store.html#a77514ee78979a91d2745f01184371e11">insert</a>(<span class="keyword">new</span> person(<span class="stringliteral">&quot;walter&quot;</span>)));</div>
<div class="line">p-&gt;add_friend(ostore.<a class="code" href="classoos_1_1object__store.html#a77514ee78979a91d2745f01184371e11">insert</a>(<span class="keyword">new</span> person(<span class="stringliteral">&quot;helen&quot;</span>)));</div>
<div class="line">p-&gt;add_friend(ostore.<a class="code" href="classoos_1_1object__store.html#a77514ee78979a91d2745f01184371e11">insert</a>(<span class="keyword">new</span> person(<span class="stringliteral">&quot;tim&quot;</span>)));</div>
</div><!-- fragment --><p>Now we can simply iterate over the list like we used to do it with all STL containers. Period.</p>
<div class="fragment"><div class="line"><span class="comment">// access all friends</span></div>
<div class="line">person::iterator i = p-&gt;begin();</div>
<div class="line"><span class="keywordflow">for</span> (i; i != p-&gt;end(); ++i) {</div>
<div class="line">  std::cout &lt;&lt; i-&gt;value()-&gt;name() &lt;&lt; std::endl;</div>
<div class="line">}</div>
</div><!-- fragment --> 
<table id="doc_nav"><tbody><tr>
  <td><div class="left-arrow-top"></td>
  <td align="left" width="40%">Prev</td>
  <td align="center" width="20%"></td>
  <td align="right" width="40%">Next</td>
  <td><div class="right-arrow-top"></td></tr><tr>
  <td><div class="left-arrow-bottom"></td>
  <td align="left" width="40%">
 <a class="el" href="store.html">Object Store</a>  
  </td>
  <td width="20%"></td>
  <td align="right" width="40%">
 <a class="el" href="view.html">Object Views</a>  
  </td><td><div class="right-arrow-bottom"></td>
</tr></tbody></table>
 
</div>
<div id="side_toc" class="width25 float_right">
 <b>Table of content</b> <br/>
</p>
<ul>
<li>
<a class="el" href="index.html">Overview</a> </li>
<li>
<a class="el" href="objects.html">Objects</a> <ul>
<li>
<a class="el" href="objects.html#step1">Derive from class object</a> </li>
<li>
<a class="el" href="objects.html#step2">Provide access methods</a> </li>
<li>
<a class="el" href="objects.html#step3">Make it serializable</a> </li>
</ul>
</li>
<li>
<a class="el" href="store.html">Object Store</a> <ul>
<li>
<a class="el" href="store.html#prototypes">Setup object hierarchy</a> </li>
<li>
<a class="el" href="store.html#add_objects">Add objects</a> </li>
<li>
<a class="el" href="store.html#modify_objects">Modify objects</a> </li>
<li>
<a class="el" href="store.html#remove_objects">Remove objects</a> </li>
</ul>
</li>
<li>
<a class="el" href="relations.html">Object Relations</a> <ul>
<li>
<a class="el" href="relations.html#one_to_one">OneToOne relations</a> </li>
<li>
<a class="el" href="relations.html#one_to_many">OneToMany relations</a> </li>
</ul>
</li>
<li>
<a class="el" href="view.html">Object Views</a> </li>
<li>
<a class="el" href="expressions.html">Expressions</a> </li>
<li>
<a class="el" href="database.html">Database</a> <ul>
<li>
<a class="el" href="database.html#support_sec">Supported Databases</a> </li>
<li>
<a class="el" href="database.html#db_relation_sec">Relations on Database</a> </li>
</ul>
</li>
</ul>
 
</div>
 </div></div><!-- contents -->
    <div class="clear" id="footer"></div>
  </div>
</body>
</html>
