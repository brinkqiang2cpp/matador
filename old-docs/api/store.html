<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"> 
<html lang="de"> 
  <head> 
    <meta http-equiv="content-type" content="text/html; charset=utf-8"/> 
    <title>Open Object Store</title> 
  	<link rel="stylesheet" type="text/css" href="style.css" />
  </head> 
  <body>
    <div id="header">
      <a href="https://github.com/zussel/oos"><img style="z-order: 10000; float: left; top: 0; left: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_left_green_007200.png" alt="Fork me on GitHub"></a>
      <div id="navigation">
        <h1>OOS</h1>
        <p>Store all your objects in one container</p>
        <ul>
          <li><a href="../index.html">Home</a></li>
          <li class="selected">Documention</li>
          <li><a href="../download.html">Download</a></li>
          <!--li><a href="../contact.html">Contact</a></li-->
          <li><a href="../about.html">About</a></li>
        </ul>
      </div>
    </div>
    <div id="wrapper">
      <div id="content">
        <div>
<!-- Generated by Doxygen 1.8.6 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Overview</span></a></li>
      <li><a href="annotated.html"><span>Documentation</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Object Store </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"> 
<div class="width75 float_left">
 
<table id="doc_nav"><tbody><tr>
  <td><div class="left-arrow-top"></td>
  <td align="left" width="40%">Prev</td>
  <td align="center" width="20%"></td>
  <td align="right" width="40%">Next</td>
  <td><div class="right-arrow-top"></td></tr><tr>
  <td><div class="left-arrow-bottom"></td>
  <td align="left" width="40%">
 <a class="el" href="objects.html">Objects</a>  
  </td>
  <td width="20%"></td>
  <td align="right" width="40%">
 <a class="el" href="relations.html">Object Relations</a>  
  </td><td><div class="right-arrow-bottom"></td>
</tr></tbody></table>
<h1><a class="anchor" id="store_sec"></a>
Object Store</h1>
<p>Now that you've written your entity classes you might want to insert them into the <a class="el" href="classoos_1_1object__store.html" title="A class that stores all kind of objects. ">oos::object_store</a>. But before doing so you have to tell the <a class="el" href="classoos_1_1object__store.html" title="A class that stores all kind of objects. ">oos::object_store</a> about your entity hierarchy once.</p>
<h2><a class="anchor" id="prototypes"></a>
Setup object hierarchy</h2>
<p>Assume we have the abstract base class Vehicle and derived from this classes Truck, Car and Bike. Now lets make this hierarchy known to the <a class="el" href="classoos_1_1object__store.html" title="A class that stores all kind of objects. ">oos::object_store</a>:</p>
<div class="fragment"><div class="line"><a class="code" href="classoos_1_1object__store.html">oos::object_store</a> ostore;</div>
<div class="line">ostore.<a class="code" href="classoos_1_1object__store.html#a6a935d8186fd6e823f916ffe63bd79c1">insert_prototype</a>&lt;Vehicle&gt;(<span class="stringliteral">&quot;vehicle&quot;</span>, <span class="keyword">true</span>);</div>
<div class="line">ostore.<a class="code" href="classoos_1_1object__store.html#a6a935d8186fd6e823f916ffe63bd79c1">insert_prototype</a>&lt;Truck, Vehicle&gt;(<span class="stringliteral">&quot;truck&quot;</span>);</div>
<div class="line">ostore.<a class="code" href="classoos_1_1object__store.html#a6a935d8186fd6e823f916ffe63bd79c1">insert_prototype</a>&lt;Car, Vehicle&gt;(<span class="stringliteral">&quot;car&quot;</span>);</div>
<div class="line">ostore.<a class="code" href="classoos_1_1object__store.html#a6a935d8186fd6e823f916ffe63bd79c1">insert_prototype</a>&lt;Bike, Vehicle&gt;(<span class="stringliteral">&quot;bike&quot;</span>);</div>
</div><!-- fragment --><p>As you can see it is quite simple to add the hierarchy to the <a class="el" href="classoos_1_1object__store.html" title="A class that stores all kind of objects. ">oos::object_store</a> by calling method <a class="el" href="classoos_1_1object__store.html#a6a935d8186fd6e823f916ffe63bd79c1">oos::object_store::insert_prototype</a>. As there are several ways to call this method we decide to use the one with template arguments.</p>
<p>The Vehicle class is an abstract base (directly derived from <a class="el" href="classoos_1_1object.html" title="The base class for all objects. ">oos::object</a>). Here we need only one template argument (the class itself: Vehicle). With the first method paramter you give your type a unique name. The second parameter is a flag telling the <a class="el" href="classoos_1_1object__store.html" title="A class that stores all kind of objects. ">oos::object_store</a> that this type is abstract. Settings this flag to true you can't insert objects of this concrete type.</p>
<h2><a class="anchor" id="add_objects"></a>
Add objects</h2>
<p>Now that we've setup up our hierarchy we can add new objects to the <a class="el" href="classoos_1_1object__store.html" title="A class that stores all kind of objects. ">oos::object_store</a>.</p>
<div class="fragment"><div class="line"><span class="keyword">typedef</span> object_ptr&lt;vehicle&gt; vehicle_ptr;</div>
<div class="line"></div>
<div class="line">vehicle_ptr truck = ostore.<a class="code" href="classoos_1_1object__store.html#a77514ee78979a91d2745f01184371e11">insert</a>(<span class="keyword">new</span> Truck(<span class="stringliteral">&quot;MAN&quot;</span>);</div>
<div class="line">vehicle_ptr car   = ostore.<a class="code" href="classoos_1_1object__store.html#a77514ee78979a91d2745f01184371e11">insert</a>(<span class="keyword">new</span> Car(<span class="stringliteral">&quot;VW Beetle&quot;</span>);</div>
<div class="line">vehicle_ptr bike  = ostore.<a class="code" href="classoos_1_1object__store.html#a77514ee78979a91d2745f01184371e11">insert</a>(<span class="keyword">new</span> Bike(<span class="stringliteral">&quot;Honda&quot;</span>);</div>
</div><!-- fragment --><p>As you can see we use <a class="el" href="classoos_1_1object__ptr.html" title="The object_ptr holds a pointer to an object. ">oos::object_ptr</a> of type vehicle. The vehicle class in our example is the abstract base class for all concrete vehicle types. So the concrete vehicle object is inserted correctly and assigned to the object_ptr.</p>
<p>That means once you have inserted an object of any concrete type you access it via an appropriate object_ptr afterwards. You should never work with the raw instance pointer. This could lead to inconsistencies.</p>
<h2><a class="anchor" id="modify_objects"></a>
Modify objects</h2>
<p>Now that we have some objects inserted we may want to modify them. The important thing here is as mentioned above that you don't deal with raw pointer to your object when try to modify it. You always have a pointer object wrapped around the object (like shared_ptr). The <a class="el" href="classoos_1_1object__store.html" title="A class that stores all kind of objects. ">oos::object_store</a> returns an <a class="el" href="classoos_1_1object__ptr.html" title="The object_ptr holds a pointer to an object. ">oos::object_ptr</a> when an object is inserted. Once you received the <a class="el" href="classoos_1_1object__ptr.html" title="The object_ptr holds a pointer to an object. ">oos::object_ptr</a> you can change your object by using it like usual pointer.</p>
<div class="fragment"><div class="line"><span class="keyword">typedef</span> <a class="code" href="classoos_1_1object__ptr.html">oos::object_ptr&lt;Truck&gt;</a> truck_ptr;</div>
<div class="line">truck_ptr truck = ostore.<a class="code" href="classoos_1_1object__store.html#a77514ee78979a91d2745f01184371e11">insert</a>(<span class="keyword">new</span> Truck(<span class="stringliteral">&quot;MAN&quot;</span>));</div>
<div class="line"></div>
<div class="line">truck-&gt;weight(2.5);</div>
<div class="line">truck-&gt;color(<span class="stringliteral">&quot;red&quot;</span>);</div>
</div><!-- fragment --><h2><a class="anchor" id="remove_objects"></a>
Remove objects</h2>
<p>Once we have an object_ptr object we can easily delete this object from the object_store by calling <a class="el" href="classoos_1_1object__store.html#ac5608375e6748903c99f6fbe3d3dfbd7">oos::object_store::remove()</a></p>
<div class="fragment"><div class="line"><span class="keyword">typedef</span> <a class="code" href="classoos_1_1object__ptr.html">oos::object_ptr&lt;Truck&gt;</a> truck_ptr;</div>
<div class="line">truck_ptr truck = ostore.<a class="code" href="classoos_1_1object__store.html#a77514ee78979a91d2745f01184371e11">insert</a>(<span class="keyword">new</span> Truck(<span class="stringliteral">&quot;MAN&quot;</span>));</div>
<div class="line"></div>
<div class="line"><span class="keywordflow">if</span> (ostore.<a class="code" href="classoos_1_1object__store.html#ad63a5e5555c7290baa905bed633b5342">is_removable</a>(truck)) {</div>
<div class="line">  <span class="comment">// remove object</span></div>
<div class="line">  ostore.<a class="code" href="classoos_1_1object__store.html#ac5608375e6748903c99f6fbe3d3dfbd7">remove</a>(truck);</div>
<div class="line">} <span class="keywordflow">else</span> {</div>
<div class="line">  <span class="comment">// object can&#39;t be removed</span></div>
<div class="line">}</div>
</div><!-- fragment --><p>When removing an object internally a check is done if the object (and subsequently all connected objects) can be removed. This test is done by checking the pointer and reference count of each concerning object. If the test succeeds the object is removed and true is returned. If the test fails false is returned.</p>
 
<table id="doc_nav"><tbody><tr>
  <td><div class="left-arrow-top"></td>
  <td align="left" width="40%">Prev</td>
  <td align="center" width="20%"></td>
  <td align="right" width="40%">Next</td>
  <td><div class="right-arrow-top"></td></tr><tr>
  <td><div class="left-arrow-bottom"></td>
  <td align="left" width="40%">
 <a class="el" href="objects.html">Objects</a>  
  </td>
  <td width="20%"></td>
  <td align="right" width="40%">
 <a class="el" href="relations.html">Object Relations</a>  
  </td><td><div class="right-arrow-bottom"></td>
</tr></tbody></table>
 
</div>
<div id="side_toc" class="width25 float_right">
 <b>Table of content</b> <br/>
</p>
<ul>
<li>
<a class="el" href="index.html">Overview</a> </li>
<li>
<a class="el" href="objects.html">Objects</a> <ul>
<li>
<a class="el" href="objects.html#step1">Derive from class object</a> </li>
<li>
<a class="el" href="objects.html#step2">Provide access methods</a> </li>
<li>
<a class="el" href="objects.html#step3">Make it serializable</a> </li>
</ul>
</li>
<li>
<a class="el" href="store.html">Object Store</a> <ul>
<li>
<a class="el" href="store.html#prototypes">Setup object hierarchy</a> </li>
<li>
<a class="el" href="store.html#add_objects">Add objects</a> </li>
<li>
<a class="el" href="store.html#modify_objects">Modify objects</a> </li>
<li>
<a class="el" href="store.html#remove_objects">Remove objects</a> </li>
</ul>
</li>
<li>
<a class="el" href="relations.html">Object Relations</a> <ul>
<li>
<a class="el" href="relations.html#one_to_one">OneToOne relations</a> </li>
<li>
<a class="el" href="relations.html#one_to_many">OneToMany relations</a> </li>
</ul>
</li>
<li>
<a class="el" href="view.html">Object Views</a> </li>
<li>
<a class="el" href="expressions.html">Expressions</a> </li>
<li>
<a class="el" href="database.html">Database</a> <ul>
<li>
<a class="el" href="database.html#support_sec">Supported Databases</a> </li>
<li>
<a class="el" href="database.html#db_relation_sec">Relations on Database</a> </li>
</ul>
</li>
</ul>
 
</div>
 </div></div><!-- contents -->
    <div class="clear" id="footer"></div>
  </div>
</body>
</html>
